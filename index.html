import React, { useState } from 'react';
import { 
  LayoutDashboard, 
  Users, 
  QrCode, 
  Calendar, 
  FileText, 
  Bell, 
  Settings, 
  LogOut, 
  CheckCircle, 
  XCircle, 
  AlertCircle, 
  Upload, 
  Camera, 
  ChevronRight, 
  RefreshCw,
  Search,
  MoreVertical,
  Plus,
  Download,
  ChevronLeft,
  PieChart,
  UserPlus,
  Edit3,
  Save,
  Clock,
  Zap,
  Sparkles,
  TrendingUp,
  MessageSquare,
  ArrowRight,
  Menu,
  Filter,
  ChevronDown,
  Monitor
} from 'lucide-react';

// --- Global Styles (Pretendard & Animations) ---
const GlobalStyles = () => (
  <style>{`
    @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css");
    
    body {
      font-family: "Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, "Helvetica Neue", "Segoe UI", "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
    }

    .glass-effect {
      background: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(255, 255, 255, 0.5);
    }
    
    .glass-card {
      background: rgba(255, 255, 255, 0.85);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(243, 244, 246, 0.6);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.02);
    }

    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }
    .hide-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    .sidebar-transition {
      transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-5px); }
      100% { transform: translateY(0px); }
    }
    .animate-float {
      animation: float 3s ease-in-out infinite;
    }

    @keyframes scan-vertical {
      0% { top: 0; opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { top: 100%; opacity: 0; }
    }
    .animate-scan-vertical {
      animation: scan-vertical 2s linear infinite;
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #0046FF 0%, #60A5FA 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
  `}</style>
);

// --- Shared Components ---

const Card = ({ children, className = "", onClick, glass = false }) => (
  <div 
    onClick={onClick} 
    className={`rounded-2xl transition-all duration-300 ${glass ? 'glass-card' : 'bg-white shadow-sm border border-gray-100'} hover:shadow-lg ${className}`}
  >
    {children}
  </div>
);

const Badge = ({ type, children }) => {
  const styles = {
    success: "bg-green-50 text-green-600 border-green-100",
    warning: "bg-yellow-50 text-yellow-600 border-yellow-100",
    danger: "bg-red-50 text-red-600 border-red-100",
    neutral: "bg-gray-50 text-gray-600 border-gray-100",
    primary: "bg-blue-50 text-blue-600 border-blue-100",
    purple: "bg-purple-50 text-purple-600 border-purple-100",
    brand: "bg-blue-600 text-white border-blue-600 shadow-md shadow-blue-200",
    dark: "bg-gray-800 text-white border-gray-700"
  };
  return (
    <span className={`px-2.5 py-1 rounded-full text-[11px] font-bold border ${styles[type] || styles.neutral} flex items-center gap-1.5 w-fit shadow-sm`}>
      {children}
    </span>
  );
};

const Button = ({ children, variant = "primary", size = "md", icon: Icon, className = "", onClick }) => {
  const baseStyle = "rounded-full font-bold transition-all flex items-center justify-center gap-2 active:scale-95 duration-200";
  const variants = {
    primary: "bg-gradient-to-r from-blue-600 to-blue-500 text-white hover:shadow-lg hover:shadow-blue-200 border border-transparent",
    secondary: "bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:border-gray-300",
    danger: "bg-red-50 text-red-600 hover:bg-red-100 border border-red-100",
    ghost: "bg-transparent text-gray-500 hover:bg-gray-100 hover:text-gray-800"
  };
  const sizes = {
    sm: "px-3 py-1.5 text-xs",
    md: "px-5 py-2.5 text-sm",
    lg: "px-6 py-3.5 text-base"
  };

  return (
    <button onClick={onClick} className={`${baseStyle} ${variants[variant]} ${sizes[size]} ${className}`}>
      {Icon && <Icon size={size === 'sm' ? 14 : 18} strokeWidth={2.5} />}
      {children}
    </button>
  );
};

// --- Mock Data ---

const MOCK_COURSES = [
  { id: 1, title: "2026 ë””ì§€í„¸ ê¸ˆìœµ ë¦¬í„°ëŸ¬ì‹œ ì‹¬í™”", status: "progress", date: "2026.10.10 ~ 10.20", students: 42, attendRate: 94 },
  { id: 2, title: "2026 ì‹ ì„ ê³¼ì¥ ë¦¬ë”ì‹­ ì—­ëŸ‰ ê°•í™”", status: "upcoming", date: "2026.11.01 ~ 11.03", students: 25, attendRate: 0 },
  { id: 3, title: "2026 ìƒë°˜ê¸° ì‹ ì…ì‚¬ì› ì…ë¬¸ ì—°ìˆ˜", status: "completed", date: "2026.01.05 ~ 02.28", students: 150, attendRate: 99 },
  { id: 4, title: "2026 ë°ì´í„° ë¶„ì„ ì „ë¬¸ê°€ ê³¼ì •", status: "completed", date: "2026.03.10 ~ 05.20", students: 30, attendRate: 92 },
];

const MOCK_STUDENTS_FULL = Array.from({ length: 15 }).map((_, i) => ({
  id: i + 1,
  name: ["ê¹€ì‹ í•œ", "ì´ê¸ˆìœµ", "ë°•íˆ¬ì", "ìµœë¯¸ë˜", "ì •ì€í–‰", "ê°•ë””ì§€í„¸", "ì¡°ë°ì´í„°", "ìœ¤AI", "í•œí´ë¼ìš°ë“œ", "ì˜¤ë³´ì•ˆ", "ì„œë¸”ë¡ì²´ì¸", "ë‚¨í•€í…Œí¬", "ì—¬í”Œë«í¼", "ì¥ì„œë¹„ìŠ¤", "ì„ê³ ê°"][i],
  dept: ["ë””ì§€í„¸ì „ëµë¶€", "ì¸ì‚¬ë¶€", "WMì‚¬ì—…ë¶€", "ICTê¸°íšë¶€", "ê³ ê°ë§Œì¡±ì„¼í„°"][i % 5],
  position: ["ëŒ€ë¦¬", "ê³¼ì¥", "ì‚¬ì›", "ì°¨ì¥", "ë¶€ë¶€ì¥"][i % 5],
  status: i === 3 ? "absent" : i === 6 ? "late" : "present",
  time: i === 3 ? "-" : i === 6 ? "09:12:05" : `08:${45 + i}:12`,
  attendRate: 90 + (i % 10),
  score: ["S", "A", "A", "C", "B", "A", "B", "S", "A", "B", "A", "S", "A", "C", "B"][i]
}));

// --- Main Application Wrapper ---

export default function ShinhanLearningOn() {
  const [viewMode, setViewMode] = useState('admin');
  const [toast, setToast] = useState(null);

  const showToast = (message, type = 'success') => {
    setToast({ message, type });
    setTimeout(() => setToast(null), 3000);
  };

  return (
    <div className="min-h-screen bg-[#F8FAFC] text-gray-800 antialiased selection:bg-blue-100 selection:text-blue-900">
      <GlobalStyles />
      
      {/* Dev Tool: Mode Switcher */}
      <div 
        className="fixed bottom-6 right-6 z-[9999] bg-gray-900/90 backdrop-blur text-white px-5 py-3 rounded-full shadow-2xl flex items-center gap-3 text-sm font-bold cursor-pointer hover:scale-105 transition-all active:scale-95 border border-white/10"
        onClick={() => setViewMode(viewMode === 'admin' ? 'user' : 'admin')}
      >
        <RefreshCw size={18} className="animate-spin-slow" />
        <span>{viewMode === 'admin' ? 'ğŸ“± í•™ìŠµì ëª¨ë“œ' : 'ğŸ’» ê´€ë¦¬ì ëª¨ë“œ'}</span>
      </div>

      {/* Global Toast */}
      {toast && (
        <div className={`fixed top-6 left-1/2 transform -translate-x-1/2 px-6 py-3.5 rounded-2xl shadow-xl text-white font-bold z-[9999] animate-bounce-in flex items-center gap-3 glass-effect border-0 ${toast.type === 'success' ? 'bg-gray-900/90' : 'bg-red-500/90'}`}>
          {toast.type === 'success' ? <CheckCircle size={20} className="text-green-400" /> : <AlertCircle size={20} />}
          {toast.message}
        </div>
      )}

      {viewMode === 'admin' ? (
        <AdminSystem showToast={showToast} />
      ) : (
        <UserMobileApp showToast={showToast} />
      )}
    </div>
  );
}

// --- Admin System ---

function AdminSystem({ showToast }) {
  const [activePage, setActivePage] = useState('dashboard');
  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(false); 
  
  const renderContent = () => {
    switch(activePage) {
      case 'dashboard': return <AdminDashboard onNavigate={setActivePage} />;
      case 'courses': return <CourseManagement onNavigate={setActivePage} showToast={showToast} />;
      case 'attendance': return <AttendanceManager showToast={showToast} />;
      case 'reports': return <PerformanceReports />;
      default: return <AdminDashboard onNavigate={setActivePage} />;
    }
  };

  return (
    <div className="flex h-screen overflow-hidden bg-[#F1F5F9]">
      <aside 
        className={`${isSidebarCollapsed ? 'w-20' : 'w-64'} bg-white/80 backdrop-blur-xl border-r border-gray-200/50 flex flex-col hidden md:flex shrink-0 z-20 sidebar-transition relative`}
      >
        <button 
          onClick={() => setIsSidebarCollapsed(!isSidebarCollapsed)}
          className="absolute -right-3 top-20 bg-white border border-gray-200 rounded-full p-1 shadow-sm text-gray-500 hover:text-blue-600 hover:border-blue-200 z-50"
        >
          {isSidebarCollapsed ? <ChevronRight size={14} /> : <ChevronLeft size={14} />}
        </button>

        <div className={`p-6 pb-4 ${isSidebarCollapsed ? 'items-center px-4' : ''} flex flex-col`}>
          <div className="flex items-center gap-3 text-[#0046FF] font-black text-2xl tracking-tight">
            <div className="w-10 h-10 bg-gradient-to-br from-[#0046FF] to-[#60A5FA] rounded-xl flex items-center justify-center text-white shadow-lg shadow-blue-200 flex-shrink-0">S</div>
            {!isSidebarCollapsed && <span className="gradient-text whitespace-nowrap">Learning ON</span>}
          </div>
          {!isSidebarCollapsed && <p className="text-[11px] font-bold text-gray-400 mt-2 pl-1 tracking-widest uppercase whitespace-nowrap">Shinhan Financial Group</p>}
        </div>
        
        <nav className="flex-1 px-3 py-6 space-y-2 overflow-y-auto">
          <NavItem icon={<LayoutDashboard size={20} />} label="ëŒ€ì‹œë³´ë“œ" active={activePage === 'dashboard'} onClick={() => setActivePage('dashboard')} collapsed={isSidebarCollapsed} />
          <NavItem icon={<Calendar size={20} />} label="ê³¼ì • ë° í•™ìŠµì" active={activePage === 'courses'} onClick={() => setActivePage('courses')} collapsed={isSidebarCollapsed} />
          <NavItem icon={<Users size={20} />} label="ì¶œê²° Live" active={activePage === 'attendance'} onClick={() => setActivePage('attendance')} collapsed={isSidebarCollapsed} />
          <NavItem icon={<PieChart size={20} />} label="ì„±ê³¼ ë¦¬í¬íŠ¸" active={activePage === 'reports'} onClick={() => setActivePage('reports')} collapsed={isSidebarCollapsed} />
          
          <div className="pt-8 mt-2">
             {!isSidebarCollapsed && (
               <div className="text-[10px] font-extrabold text-gray-400 px-5 mb-3 uppercase tracking-wider flex items-center gap-2">
                 System <div className="h-px flex-1 bg-gray-100"></div>
               </div>
             )}
             <NavItem icon={<Settings size={20} />} label="ì„¤ì •" collapsed={isSidebarCollapsed} />
             <NavItem icon={<LogOut size={20} />} label="ë¡œê·¸ì•„ì›ƒ" collapsed={isSidebarCollapsed} />
          </div>
        </nav>

        <div className="p-4">
          <div className={`glass-card p-3 rounded-2xl flex items-center gap-3 hover:scale-[1.02] transition-transform cursor-pointer ${isSidebarCollapsed ? 'justify-center' : ''}`}>
            <div className="w-9 h-9 rounded-full bg-gradient-to-tr from-gray-100 to-gray-200 flex items-center justify-center text-gray-600 font-bold border border-white shadow-sm flex-shrink-0">
              HR
            </div>
            {!isSidebarCollapsed && (
              <div className="min-w-0">
                <p className="text-sm font-bold text-gray-800 truncate">ê¹€ì¸ì‚¬ ë§¤ë‹ˆì €</p>
                <p className="text-xs font-medium text-gray-500 truncate">ì¸ì¬ê°œë°œíŒ€</p>
              </div>
            )}
          </div>
        </div>
      </aside>

      <main className="flex-1 overflow-y-auto relative bg-[#F8FAFC]">
        <header className="h-20 flex items-center justify-between px-8 sticky top-0 z-30 bg-[#F8FAFC]/80 backdrop-blur-md">
          <div className="flex items-center gap-3">
             {activePage !== 'dashboard' && (
                <button onClick={() => setActivePage('dashboard')} className="p-2 hover:bg-white rounded-full transition-colors shadow-sm border border-transparent hover:border-gray-100">
                  <ChevronLeft size={22} className="text-gray-600" />
                </button>
             )}
             <div>
               <h2 className="text-xl font-bold text-gray-900 tracking-tight flex items-center gap-2">
                 {activePage === 'dashboard' && 'ğŸ‘‹ ë°˜ê°€ì›Œìš”, ê¹€ì¸ì‚¬ë‹˜!'}
                 {activePage === 'courses' && 'ğŸ“š ê³¼ì • ë° í•™ìŠµì ì„¸íŒ…'}
                 {activePage === 'attendance' && 'âš¡ï¸ ì‹¤ì‹œê°„ ì¶œê²° ê´€ë¦¬'}
                 {activePage === 'reports' && 'ğŸ“Š ì„±ê³¼ ë¶„ì„ ë¦¬í¬íŠ¸'}
               </h2>
             </div>
          </div>
          <div className="flex items-center gap-4">
            <div className="relative group hidden lg:block">
              <Search className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 group-hover:text-blue-500 transition-colors" size={18} />
              <input type="text" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš” (Cmd+K)" className="pl-11 pr-5 py-2.5 bg-white border border-gray-200 rounded-full text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 w-72 transition-all shadow-sm group-hover:shadow-md" />
            </div>
            <button className="p-2.5 bg-white border border-gray-200 text-gray-600 hover:text-blue-600 hover:border-blue-200 rounded-full relative shadow-sm transition-all hover:scale-105">
              <Bell size={20} />
              <span className="absolute top-2 right-2.5 w-2 h-2 bg-red-500 rounded-full ring-2 ring-white animate-pulse"></span>
            </button>
          </div>
        </header>

        <div className="px-8 pb-10 max-w-[1920px] mx-auto min-h-[calc(100vh-5rem)]">
          {renderContent()}
        </div>
      </main>
    </div>
  );
}

// --- Admin Pages ---

function AdminDashboard({ onNavigate }) {
  const [courseFilter, setCourseFilter] = useState('all');

  const filteredCourses = courseFilter === 'all' 
    ? MOCK_COURSES 
    : MOCK_COURSES.filter(c => c.status === courseFilter);

  return (
    <div className="space-y-6 animate-fade-in-up">
      <div className="grid grid-cols-1 md:grid-cols-4 gap-5">
        <div className="glass-card p-6 rounded-2xl flex flex-col justify-between hover:shadow-lg transition-all border border-white/50 relative group">
          <div className="absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity">
            <select className="bg-gray-50 border border-gray-200 rounded-lg text-[10px] p-1 outline-none text-gray-600 font-bold">
              <option>10ì›”</option>
              <option>9ì›”</option>
              <option>8ì›”</option>
            </select>
          </div>
          <div className="flex justify-between items-start mb-4">
            <div className="p-3 rounded-2xl bg-blue-50 text-blue-600 border border-blue-100">
              <CheckCircle size={22} strokeWidth={2.5} />
            </div>
            <span className="text-[10px] font-bold px-2 py-1 rounded-full bg-blue-100 text-blue-600">+2.4%</span>
          </div>
          <div>
            <p className="text-xs font-bold text-gray-400 uppercase tracking-wide mb-1 flex items-center gap-1">ì´ë²ˆ ë‹¬(10ì›”) ì¶œì„ë¥  <ChevronDown size={12}/></p>
            <h3 className="text-2xl font-black text-gray-800 tracking-tight">94.2%</h3>
            <p className="text-xs font-medium text-gray-500 mt-2 flex items-center gap-1">ì „ì›” ëŒ€ë¹„ ìƒìŠ¹ ğŸ”¥</p>
          </div>
        </div>
        
        <StatCard title="ë¯¸ì¶œê²° / ì§€ê°" value="5ëª…" sub="ì˜¤ëŠ˜ í™•ì¸ í•„ìš” ğŸš¨" color="red" icon={<AlertCircle />} trend="New" />
        <StatCard title="ì†Œëª… ì‹ ì²­" value="3ê±´" sub="ì‹ ê·œ ì ‘ìˆ˜ ğŸ“©" color="purple" icon={<MessageSquare />} onClick={() => onNavigate('attendance')} cursor trend="Wait" />
        <StatCard title="í‰ê·  ì„±ì·¨ë„" value="A-" sub="ìƒìŠ¹ì„¸ ğŸ“ˆ" color="green" icon={<TrendingUp />} trend="Good" />
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <Card className="lg:col-span-2 p-7 glass-card border-none shadow-sm flex flex-col" glass>
          <div className="flex justify-between items-center mb-6">
            <div>
              <h3 className="font-bold text-xl text-gray-800 flex items-center gap-2">ì „ì²´ ê³¼ì • ìš´ì˜ í˜„í™© ğŸ“‚</h3>
              <p className="text-sm text-gray-500 mt-1">í˜„ì¬ ìš´ì˜ ì¤‘ì´ê±°ë‚˜ ì™„ë£Œëœ ëª¨ë“  êµìœ¡ ê³¼ì •ì…ë‹ˆë‹¤.</p>
            </div>
            <div className="bg-gray-100/80 p-1 rounded-xl flex">
               {['all', 'progress', 'upcoming', 'completed'].map(f => (
                 <button 
                  key={f}
                  onClick={() => setCourseFilter(f)}
                  className={`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${courseFilter === f ? 'bg-white shadow-sm text-gray-800' : 'text-gray-400 hover:text-gray-600'}`}
                 >
                   {f === 'all' && 'ì „ì²´'}
                   {f === 'progress' && 'ì§„í–‰ì¤‘'}
                   {f === 'upcoming' && 'ì˜ˆì •'}
                   {f === 'completed' && 'ì™„ë£Œ'}
                 </button>
               ))}
            </div>
          </div>
          
          <div className="space-y-3 overflow-y-auto max-h-[500px] pr-2 custom-scrollbar">
            {filteredCourses.map(course => (
              <div key={course.id} className="group p-5 rounded-2xl bg-white border border-gray-100 hover:border-blue-300 hover:shadow-lg hover:shadow-blue-50 transition-all cursor-pointer relative overflow-hidden" onClick={() => onNavigate('attendance')}>
                <div className={`flex justify-between items-start mb-3 relative z-10 opacity-${course.status === 'completed' ? '60' : '100'}`}>
                  <div className="flex gap-3 items-center">
                    <Badge type={course.status === 'progress' ? 'success' : course.status === 'upcoming' ? 'neutral' : 'dark'}>
                       {course.status === 'progress' && 'ì§„í–‰ì¤‘ ğŸ”¥'}
                       {course.status === 'upcoming' && 'ì˜ˆì • ğŸ—“ï¸'}
                       {course.status === 'completed' && 'ì™„ë£Œ âœ…'}
                    </Badge>
                    <h4 className={`font-bold text-lg ${course.status === 'completed' ? 'text-gray-500 line-through' : 'text-gray-800'} group-hover:text-blue-600 transition-colors`}>{course.title}</h4>
                  </div>
                  {course.status === 'progress' && (
                    <div className="w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center text-gray-400 group-hover:bg-blue-600 group-hover:text-white transition-all">
                      <ChevronRight size={18} />
                    </div>
                  )}
                </div>
                <div className="flex items-center gap-6 text-sm text-gray-500 mt-4 relative z-10">
                  <div className="flex items-center gap-2 font-medium bg-gray-50 px-3 py-1.5 rounded-lg"><Calendar size={14} className="text-blue-500"/> {course.date}</div>
                  <div className="flex items-center gap-2 font-medium bg-gray-50 px-3 py-1.5 rounded-lg"><Users size={14} className="text-purple-500"/> {course.students}ëª…</div>
                  {course.status !== 'upcoming' && (
                    <div className="flex-1 ml-4 flex items-center gap-3">
                      <span className="text-xs font-bold text-gray-400">ìµœì¢… ì¶œì„ë¥ </span>
                      <div className="flex-1 h-2.5 bg-gray-100 rounded-full overflow-hidden">
                        <div className={`h-full rounded-full ${course.status === 'completed' ? 'bg-gray-400' : 'bg-gradient-to-r from-blue-500 to-blue-400'}`} style={{width: `${course.attendRate}%`}}></div>
                      </div>
                      <span className={`text-sm font-bold ${course.status === 'completed' ? 'text-gray-600' : 'text-blue-600'}`}>{course.attendRate}%</span>
                    </div>
                  )}
                </div>
              </div>
            ))}
            
            <div className="p-5 border-2 border-dashed border-gray-200 rounded-2xl flex items-center justify-center text-gray-400 hover:text-blue-600 hover:border-blue-300 hover:bg-blue-50/50 cursor-pointer transition-all gap-2 group" onClick={() => onNavigate('courses')}>
              <Plus size={18} />
              <span className="font-bold text-sm">2026ë…„ ì‹ ê·œ ê³¼ì • ê°œì„¤í•˜ê¸°</span>
            </div>
          </div>
        </Card>

        <Card className="p-7 glass-card border-none shadow-sm flex flex-col h-full" glass>
          <div className="flex justify-between items-center mb-6">
             <h3 className="font-bold text-xl text-gray-800">ì´ìŠˆ íŠ¸ë˜ì»¤ âš¡ï¸</h3>
             <Badge type="danger">3ê±´ ëŒ€ê¸°</Badge>
          </div>
          <div className="space-y-3 flex-1">
             <IssueItem name="ìµœë¯¸ë˜" dept="ICTê¸°íšë¶€" time="10:15" issue="ì¥ê¸° í™”ë©´ ì´íƒˆ (30ë¶„)" type="danger" emoji="ğŸ˜´" />
             <IssueItem name="ë°•íˆ¬ì" dept="WMì‚¬ì—…ë¶€" time="09:00" issue="ì§€ê° ì‚¬ìœ ì„œ ë¯¸ì œì¶œ" type="warning" emoji="ğŸ“" />
             <IssueItem name="ê¹€ì‹ í•œ" dept="ë””ì§€í„¸ì „ëµë¶€" time="11:30" issue="ì¦ë¹™ ì‚¬ì§„ ì‹ë³„ ë¶ˆê°€" type="warning" emoji="ğŸ“·" />
          </div>
          <Button className="w-full mt-6 bg-gray-900 text-white hover:bg-gray-800" onClick={() => onNavigate('attendance')}>ì¼ê´„ ì²˜ë¦¬í•˜ê¸°</Button>
        </Card>
      </div>
    </div>
  );
}

function CourseManagement({ showToast, onNavigate }) {
  const [activeTab, setActiveTab] = useState('list'); 

  return (
    <div className="space-y-8 animate-fade-in-up">
      <div className="flex border-b border-gray-200/60 relative">
        {['list', 'create', 'students'].map((tab) => (
          <button 
            key={tab}
            onClick={() => setActiveTab(tab)} 
            className={`px-8 py-4 font-bold text-sm relative transition-colors ${activeTab === tab ? 'text-blue-600' : 'text-gray-400 hover:text-gray-600'}`}
          >
            {tab === 'list' && 'ğŸ“‚ ê³¼ì • ëª©ë¡'}
            {tab === 'create' && 'âœ¨ ê³¼ì • ê°œì„¤'}
            {tab === 'students' && 'ğŸ‘¥ í•™ìŠµì DB'}
            {activeTab === tab && <div className="absolute bottom-0 left-0 w-full h-0.5 bg-blue-600 rounded-t-full"></div>}
          </button>
        ))}
      </div>

      {activeTab === 'list' && (
        <Card className="p-1 min-h-[400px]">
           <div className="p-8">
              <div className="flex justify-between items-center mb-6">
                 <h3 className="font-bold text-lg text-gray-800">ê´€ë¦¬ ì¤‘ì¸ ê³¼ì •</h3>
                 <div className="flex gap-2">
                   <Button size="sm" variant="secondary" icon={Filter}>í•„í„°</Button>
                   <Button size="sm" variant="primary" icon={Plus} onClick={() => setActiveTab('create')}>ì‹ ê·œ ê³¼ì •</Button>
                 </div>
              </div>
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
                {MOCK_COURSES.map(course => (
                  <div key={course.id} className="flex items-center justify-between p-6 bg-white border border-gray-100 rounded-2xl hover:shadow-md hover:border-blue-200 transition-all text-left group cursor-pointer" onClick={() => onNavigate('attendance')}>
                    <div>
                      <div className="flex gap-3 mb-2">
                        <Badge type={course.status === 'progress' ? 'success' : course.status === 'upcoming' ? 'neutral' : 'dark'}>
                           {course.status === 'progress' && 'ì§„í–‰ì¤‘'}
                           {course.status === 'upcoming' && 'ì˜ˆì •'}
                           {course.status === 'completed' && 'ì™„ë£Œ'}
                        </Badge>
                        <span className="font-bold text-lg text-gray-800 group-hover:text-blue-600 transition-colors">{course.title}</span>
                      </div>
                      <span className="text-sm font-medium text-gray-400 flex items-center gap-2"><Clock size={14}/> {course.date}</span>
                    </div>
                    <div className="flex gap-3 opacity-50 group-hover:opacity-100 transition-opacity">
                       <Button size="sm" variant="secondary" icon={Edit3}>ìˆ˜ì •</Button>
                       <Button size="sm" variant="primary" icon={Users}>ê´€ë¦¬</Button>
                    </div>
                  </div>
                ))}
              </div>
           </div>
        </Card>
      )}

      {activeTab === 'create' && (
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
           <Card className="p-8 space-y-6">
              <h3 className="font-bold text-xl mb-6 flex items-center gap-2">ê¸°ë³¸ ì •ë³´ <span className="text-blue-500 text-sm font-normal">Step 1</span></h3>
              <div className="space-y-5">
                 <div>
                    <label className="block text-sm font-bold text-gray-700 mb-2">ê³¼ì •ëª… ğŸ·ï¸</label>
                    <input type="text" className="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all" placeholder="ì˜ˆ: 2026 í•˜ë°˜ê¸° ì‹ ì…ì‚¬ì› ì—°ìˆ˜" />
                 </div>
                 <div className="grid grid-cols-2 gap-5">
                    <div>
                        <label className="block text-sm font-bold text-gray-700 mb-2">ì‹œì‘ì¼ ğŸ›«</label>
                        <input type="date" className="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-medium" />
                    </div>
                    <div>
                        <label className="block text-sm font-bold text-gray-700 mb-2">ì¢…ë£Œì¼ ğŸ›¬</label>
                        <input type="date" className="w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3 text-sm font-medium" />
                    </div>
                 </div>
                 <div>
                    <label className="block text-sm font-bold text-gray-700 mb-2">êµìœ¡ ë°©ì‹ ğŸ“¡</label>
                    <div className="flex gap-3 mt-1">
                       {['ëŒ€ë©´ (Offline)', 'ë¹„ëŒ€ë©´ (Zoom)', 'í•˜ì´ë¸Œë¦¬ë“œ'].map((type, i) => (
                         <label key={i} className="flex-1 cursor-pointer">
                           <input type="radio" name="type" className="peer sr-only" defaultChecked={i===2} />
                           <div className="w-full text-center py-3 rounded-xl border-2 border-gray-100 text-gray-500 font-bold text-sm peer-checked:border-blue-500 peer-checked:text-blue-600 peer-checked:bg-blue-50 transition-all">
                             {type}
                           </div>
                         </label>
                       ))}
                    </div>
                 </div>
              </div>
           </Card>
           
           <Card className="p-8 flex flex-col justify-between relative overflow-hidden">
              <div className="absolute top-0 right-0 w-40 h-40 bg-blue-100 rounded-full blur-3xl opacity-50 -mr-10 -mt-10"></div>
              <div className="relative z-10">
                <h3 className="font-bold text-xl mb-6 flex items-center gap-2">í•™ìŠµì ì„¸íŒ… <span className="text-blue-500 text-sm font-normal">Step 2</span></h3>
                <div className="border-3 border-dashed border-gray-200 rounded-2xl p-10 flex flex-col items-center justify-center text-center bg-gray-50/50 hover:bg-blue-50 hover:border-blue-300 transition-all cursor-pointer group h-64">
                   <div className="w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-lg shadow-gray-100 mb-4 group-hover:scale-110 group-hover:rotate-6 transition-all duration-300">
                      <FileText className="text-gray-400 group-hover:text-blue-500" size={32} />
                   </div>
                   <p className="font-bold text-lg text-gray-700">ëª…ë‹¨ ì¼ê´„ ì—…ë¡œë“œ</p>
                   <p className="text-sm text-gray-400 mt-2 font-medium">ì—‘ì…€ íŒŒì¼(.xlsx)ì„ ì—¬ê¸°ë¡œ ëŒì–´ì˜¤ì„¸ìš”.</p>
                </div>
              </div>
              <div className="flex justify-end gap-3 mt-8 relative z-10">
                 <Button variant="secondary" className="px-8">ì·¨ì†Œ</Button>
                 <Button className="px-8 shadow-lg shadow-blue-300/50" onClick={() => {showToast("2026ë…„ ì‹ ê·œ ê³¼ì •ì´ ê°œì„¤ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰"); setActiveTab('list');}}>ê³¼ì • ìƒì„± ì™„ë£Œ</Button>
              </div>
           </Card>
        </div>
      )}

      {activeTab === 'students' && (
         <Card className="p-0 overflow-hidden border-0 shadow-sm">
            <div className="p-6 border-b border-gray-100 flex justify-between items-center bg-white">
               <div className="flex items-center gap-3">
                  <h3 className="font-bold text-lg text-gray-800">2026ë…„ í•™ìŠµì DB</h3>
                  <Badge type="neutral">ì´ 15ëª…</Badge>
               </div>
               <div className="flex gap-2">
                  <Button size="sm" variant="secondary" icon={Upload}>ì—‘ì…€ ì—…ë¡œë“œ</Button>
                  <Button size="sm" variant="primary" icon={UserPlus}>ê°œë³„ ë“±ë¡</Button>
               </div>
            </div>
            <div className="overflow-x-auto">
               <table className="w-full text-sm text-left">
                  <thead className="bg-gray-50 text-gray-500 text-xs font-bold uppercase tracking-wider">
                     <tr>
                        <th className="px-6 py-4 rounded-tl-lg">ì‚¬ë²ˆ</th>
                        <th className="px-6 py-4">ì´ë¦„</th>
                        <th className="px-6 py-4">ë¶€ì„œ/ì§ê¸‰</th>
                        <th className="px-6 py-4">ìµœê·¼ ì´ìˆ˜ ê³¼ì •</th>
                        <th className="px-6 py-4 text-center rounded-tr-lg">ê´€ë¦¬</th>
                     </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-100 bg-white">
                     {MOCK_STUDENTS_FULL.slice(0, 5).map(s => (
                        <tr key={s.id} className="hover:bg-blue-50/30 transition-colors">
                           <td className="px-6 py-4 text-gray-500 font-mono">202600{s.id}</td>
                           <td className="px-6 py-4 font-bold text-gray-800">{s.name}</td>
                           <td className="px-6 py-4 text-gray-500 font-medium"><Badge type="neutral">{s.dept}</Badge></td>
                           <td className="px-6 py-4 text-gray-600 font-medium">2026 ë””ì§€í„¸ ê¸ˆìœµ ë¦¬í„°ëŸ¬ì‹œ</td>
                           <td className="px-6 py-4 text-center">
                              <button className="p-2 rounded-full hover:bg-gray-100 text-gray-400 hover:text-blue-600 transition-all"><Edit3 size={16}/></button>
                           </td>
                        </tr>
                     ))}
                  </tbody>
               </table>
            </div>
         </Card>
      )}
    </div>
  );
}

function AttendanceManager({ showToast }) {
  const [mode, setMode] = useState('online');
  const [selectedStudent, setSelectedStudent] = useState(null);

  return (
    <div className="space-y-8 animate-fade-in-up">
      {/* Hip Control Bar */}
      <div className="flex justify-between items-center bg-white p-5 rounded-2xl shadow-sm border border-gray-100">
         <div className="flex items-center gap-6">
            <div className="bg-gray-100 p-1.5 rounded-xl flex shadow-inner">
               <button onClick={() => setMode('online')} className={`px-5 py-2.5 rounded-lg text-sm font-bold transition-all flex items-center gap-2 ${mode === 'online' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500 hover:text-gray-700'}`}><Monitor size={16}/> ë¹„ëŒ€ë©´</button>
               <button onClick={() => setMode('offline')} className={`px-5 py-2.5 rounded-lg text-sm font-bold transition-all flex items-center gap-2 ${mode === 'offline' ? 'bg-white text-blue-600 shadow-sm' : 'text-gray-500 hover:text-gray-700'}`}><QrCode size={16}/> ëŒ€ë©´</button>
            </div>
            <div className="h-10 w-px bg-gray-100"></div>
            <div>
               <span className="text-xs font-bold text-blue-500 block mb-1">CURRENT CLASS</span>
               <div className="flex items-center gap-2">
                  <span className="text-lg font-bold text-gray-800 tracking-tight">2026 ë””ì§€í„¸ ê¸ˆìœµ ë¦¬í„°ëŸ¬ì‹œ ì‹¬í™”</span>
                  <div className="animate-pulse w-2 h-2 rounded-full bg-green-500"></div>
               </div>
            </div>
         </div>
         <div className="flex gap-3">
            <Button variant="secondary" size="md" icon={Download}>ì¶œì„ë¶€</Button>
            <Button variant="primary" size="md" icon={Save}>ë§ˆê° í™•ì •</Button>
         </div>
      </div>

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
         {/* Main List */}
         <Card className="lg:col-span-2 p-0 flex flex-col h-[650px] border-0 shadow-sm">
            <div className="p-5 border-b border-gray-100 flex justify-between items-center bg-white rounded-t-2xl">
               <h3 className="font-bold text-gray-800 flex items-center gap-2"><Sparkles size={16} className="text-yellow-500"/> ì‹¤ì‹œê°„ í•™ìŠµì í˜„í™©</h3>
               <div className="flex gap-3 text-xs font-bold">
                  <span className="flex items-center gap-1.5 px-3 py-1.5 bg-green-50 text-green-700 rounded-full"><div className="w-2 h-2 rounded-full bg-green-500"></div>ì¶œì„ 12</span>
                  <span className="flex items-center gap-1.5 px-3 py-1.5 bg-yellow-50 text-yellow-700 rounded-full"><div className="w-2 h-2 rounded-full bg-yellow-500"></div>ì§€ê° 1</span>
                  <span className="flex items-center gap-1.5 px-3 py-1.5 bg-red-50 text-red-700 rounded-full"><div className="w-2 h-2 rounded-full bg-red-500"></div>ê²°ì„ 1</span>
               </div>
            </div>
            <div className="flex-1 overflow-y-auto bg-white rounded-b-2xl">
               <table className="w-full text-sm text-left sticky top-0">
                  <thead className="bg-gray-50 text-gray-500 text-xs font-bold uppercase sticky top-0 z-10">
                     <tr>
                        <th className="px-6 py-3">ì´ë¦„/ì†Œì†</th>
                        <th className="px-6 py-3">ì¸ì¦ ì‹œê°„</th>
                        <th className="px-6 py-3">ìƒíƒœ</th>
                        <th className="px-6 py-3 text-center">Action</th>
                     </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-50">
                     {MOCK_STUDENTS_FULL.map((s) => (
                        <tr key={s.id} className="hover:bg-blue-50/40 cursor-pointer transition-colors group" onClick={() => setSelectedStudent(s)}>
                           <td className="px-6 py-4">
                              <div className="font-bold text-gray-900 flex items-center gap-2">
                                {s.name}
                                {s.status === 'late' && <span className="text-[10px] bg-gray-100 px-1.5 rounded text-gray-500">ì‚¬ìœ ì„œ ë¯¸ì œì¶œ</span>}
                              </div>
                              <div className="text-xs font-medium text-gray-400 mt-0.5">{s.dept}</div>
                           </td>
                           <td className="px-6 py-4 font-mono font-medium text-gray-600">{s.time}</td>
                           <td className="px-6 py-4">
                              <Badge type={s.status === 'present' ? 'success' : s.status === 'late' ? 'warning' : 'danger'}>
                                 {s.status === 'present' ? 'ì¶œì„' : s.status === 'late' ? 'ì§€ê°' : 'ê²°ì„'}
                              </Badge>
                           </td>
                           <td className="px-6 py-4 text-center">
                              <div className="flex justify-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                                 <button onClick={(e)=>{e.stopPropagation(); showToast(`âœ… ${s.name}ë‹˜ ì¶œì„ ì²˜ë¦¬ ì™„ë£Œ`);}} className="p-1.5 hover:bg-green-100 text-green-600 rounded-lg transition-colors"><CheckCircle size={18}/></button>
                                 <button onClick={(e)=>{e.stopPropagation(); showToast(`ğŸš¨ ${s.name}ë‹˜ ê²°ì„ ì²˜ë¦¬ ì™„ë£Œ`, 'error');}} className="p-1.5 hover:bg-red-100 text-red-600 rounded-lg transition-colors"><XCircle size={18}/></button>
                              </div>
                           </td>
                        </tr>
                     ))}
                  </tbody>
               </table>
            </div>
         </Card>

         {/* Side Panel */}
         <div className="space-y-6">
            <Card className="p-8 bg-gradient-to-br from-white to-blue-50/50 border-white shadow-lg text-center relative overflow-hidden" glass>
               {mode === 'offline' ? (
                  <>
                     <div className="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500"></div>
                     <Badge type="brand" className="mx-auto mb-4">Dynamic QR Live</Badge>
                     <h3 className="font-bold text-xl text-gray-800 mb-2">ì¶œì„ ìŠ¤ìº”í•´ì£¼ì„¸ìš” ğŸ“¸</h3>
                     <p className="text-xs font-medium text-gray-500 mb-6">ì½”ë“œëŠ” 10ì´ˆë§ˆë‹¤ ìë™ ê°±ì‹ ë©ë‹ˆë‹¤.</p>
                     <div className="bg-white p-4 rounded-2xl shadow-xl border border-gray-100 inline-block relative overflow-hidden group hover:scale-105 transition-transform duration-500">
                        <QrCode size={160} className="text-gray-900" />
                        <div className="absolute top-0 left-0 w-full h-2 bg-blue-500/50 blur-sm animate-scan"></div>
                     </div>
                     <div className="mt-6 flex justify-center items-center gap-2 bg-white/50 py-2 rounded-full w-fit mx-auto px-4 backdrop-blur-sm">
                        <div className="w-2 h-2 bg-green-500 rounded-full animate-ping"></div>
                        <span className="text-xs font-bold text-green-600">ì‹¤ì‹œê°„ í™œì„±í™”ë¨</span>
                     </div>
                  </>
               ) : (
                  <>
                     <div className="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-float">
                       <Upload className="text-blue-600" size={28}/>
                     </div>
                     <h3 className="font-bold text-xl text-gray-800 mb-2">ì¦ë¹™ ìº¡ì²˜ ì—…ë¡œë“œ â˜ï¸</h3>
                     <p className="text-xs font-medium text-gray-400 mb-6">Zoom í™”ë©´ì„ ìº¡ì²˜í•´ì„œ ì˜¬ë ¤ì£¼ì„¸ìš”.</p>
                     <div className="border-3 border-dashed border-blue-200 bg-blue-50/30 rounded-2xl h-40 flex flex-col items-center justify-center cursor-pointer hover:bg-blue-50 hover:border-blue-400 transition-all group" onClick={() => showToast("ì´ë¯¸ì§€ê°€ ì—…ë¡œë“œ ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“¤")}>
                        <span className="text-sm font-bold text-gray-600 group-hover:text-blue-600">ì´ë¯¸ì§€ Drag & Drop</span>
                        <span className="text-[10px] text-blue-400 mt-2 font-medium bg-white px-2 py-1 rounded-full shadow-sm">Auto Timestamp</span>
                     </div>
                  </>
               )}
            </Card>

            {/* Student Detail Modal */}
            {selectedStudent ? (
               <Card className="p-6 border-l-4 border-l-blue-500 animate-slide-up shadow-lg">
                  <div className="flex justify-between items-start mb-6">
                     <div className="flex gap-3">
                        <div className="w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-xl">ğŸ‘¤</div>
                        <div>
                           <h4 className="font-bold text-lg text-gray-900">{selectedStudent.name}</h4>
                           <p className="text-xs font-medium text-gray-500">{selectedStudent.dept} {selectedStudent.position}</p>
                        </div>
                     </div>
                     <button onClick={() => setSelectedStudent(null)} className="p-1 hover:bg-gray-100 rounded-full"><XCircle size={20} className="text-gray-400"/></button>
                  </div>
                  <div className="space-y-4 bg-gray-50 p-4 rounded-xl">
                     <div className="flex justify-between text-sm">
                        <span className="text-gray-500 font-medium">ì…ì‹¤ ì‹œê°„</span>
                        <span className="font-mono font-bold">{selectedStudent.time}</span>
                     </div>
                     <div className="flex justify-between text-sm items-center">
                        <span className="text-gray-500 font-medium">í˜„ì¬ ìƒíƒœ</span>
                        <Badge type={selectedStudent.status === 'present' ? 'success' : selectedStudent.status === 'late' ? 'warning' : 'danger'}>
                           {selectedStudent.status === 'present' ? 'ì •ìƒ ì¶œì„' : selectedStudent.status === 'late' ? 'ì§€ê°' : 'ê²°ì„'}
                        </Badge>
                     </div>
                  </div>
                  <div className="mt-4">
                     <label className="block text-xs font-bold text-gray-700 mb-2">ê´€ë¦¬ì ë©”ëª¨ âœï¸</label>
                     <textarea className="w-full bg-white border border-gray-200 rounded-xl p-3 text-xs font-medium h-20 resize-none focus:ring-2 focus:ring-blue-100 focus:border-blue-400 outline-none" placeholder="íŠ¹ì´ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                     <Button size="sm" className="w-full mt-3 font-bold" onClick={() => {showToast("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤ âœ¨"); setSelectedStudent(null);}}>ì €ì¥í•˜ê¸°</Button>
                  </div>
               </Card>
            ) : (
               <Card className="p-8 text-center text-gray-400 py-16 border-2 border-dashed border-gray-200 bg-gray-50/50">
                  <p className="text-sm font-medium">ğŸ‘ˆ ë¦¬ìŠ¤íŠ¸ì—ì„œ í•™ìŠµìë¥¼ ì„ íƒí•˜ë©´<br/>ìƒì„¸ ì •ë³´ê°€ í‘œì‹œë©ë‹ˆë‹¤.</p>
               </Card>
            )}
         </div>
      </div>
    </div>
  );
}

function PerformanceReports() {
  return (
    <div className="space-y-8 animate-fade-in-up">
       <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
          <Card className="p-8">
             <h3 className="font-bold text-xl mb-6 flex items-center gap-2">ì¢…í•© ì„±ì·¨ë„ ë¶„í¬ ğŸ“Š</h3>
             <div className="flex items-end justify-center h-48 gap-6 px-10">
                <div className="w-16 bg-blue-100 h-[20%] rounded-t-2xl relative group hover:bg-blue-200 transition-colors flex justify-center"><span className="absolute -top-6 text-xs font-bold text-gray-500">C</span></div>
                <div className="w-16 bg-blue-300 h-[45%] rounded-t-2xl relative group hover:bg-blue-400 transition-colors flex justify-center"><span className="absolute -top-6 text-xs font-bold text-gray-500">B</span></div>
                <div className="w-16 bg-blue-500 h-[70%] rounded-t-2xl relative group hover:bg-blue-600 transition-colors flex justify-center"><span className="absolute -top-6 text-xs font-bold text-blue-600">A</span></div>
                <div className="w-16 bg-gray-800 h-[30%] rounded-t-2xl relative group hover:bg-gray-700 transition-colors flex justify-center"><span className="absolute -top-6 text-xs font-bold text-gray-800">S</span></div>
             </div>
             <p className="text-center text-sm font-bold text-gray-500 mt-6 bg-gray-50 py-2 rounded-lg">ì „ì²´ í‰ê·  <span className="text-blue-600">B+ ì´ìƒ</span> ë‹¬ì„± ì¤‘ì…ë‹ˆë‹¤ ğŸ‘</p>
          </Card>
          <Card className="p-8 flex flex-col">
             <h3 className="font-bold text-xl mb-6">ì£¼ìš” ì¸ì‚¬ì´íŠ¸ ğŸ’¡</h3>
             <div className="space-y-4 flex-1">
               <div className="bg-green-50 p-4 rounded-xl border border-green-100 flex gap-3 items-start">
                  <div className="p-1 bg-green-200 rounded-full"><TrendingUp size={14} className="text-green-700"/></div>
                  <div>
                    <h4 className="font-bold text-sm text-green-800">ì¶œì„ë¥  ìƒìŠ¹</h4>
                    <p className="text-xs text-green-700 mt-1">ì§€ë‚œ ê¸°ìˆ˜ ëŒ€ë¹„ ì¶œì„ë¥ ì´ 5.2% ìƒìŠ¹í–ˆìŠµë‹ˆë‹¤.</p>
                  </div>
               </div>
               <div className="bg-blue-50 p-4 rounded-xl border border-blue-100 flex gap-3 items-start">
                  <div className="p-1 bg-blue-200 rounded-full"><Zap size={14} className="text-blue-700"/></div>
                  <div>
                    <h4 className="font-bold text-sm text-blue-800">ë””ì§€í„¸ ì—­ëŸ‰ ê°•í™”</h4>
                    <p className="text-xs text-blue-700 mt-1">ë°ì´í„° ë¶„ì„ ê³¼ì œ í‰ê·  ì ìˆ˜ê°€ Aë“±ê¸‰ì…ë‹ˆë‹¤.</p>
                  </div>
               </div>
             </div>
          </Card>
       </div>

       <Card className="p-0 border-0 shadow-sm overflow-hidden">
          <div className="p-6 border-b border-gray-100 flex justify-between items-center bg-white">
             <h3 className="font-bold text-lg text-gray-800">2026ë…„ ê°œë³„ ì„±ê³¼ ë¦¬í¬íŠ¸</h3>
             <Button size="sm" variant="secondary" icon={Download}>ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</Button>
          </div>
          <div className="overflow-x-auto bg-white">
             <table className="w-full text-sm text-left">
                <thead className="bg-gray-50 text-gray-500 text-xs font-bold uppercase">
                   <tr>
                      <th className="px-6 py-4">Ranking</th>
                      <th className="px-6 py-4">í•™ìŠµì</th>
                      <th className="px-6 py-4">ì¶œì„ë¥  (40%)</th>
                      <th className="px-6 py-4">ê³¼ì œ (30%)</th>
                      <th className="px-6 py-4">ì‹œí—˜ (30%)</th>
                      <th className="px-6 py-4">Final Grade</th>
                      <th className="px-6 py-4 text-center">Detail</th>
                   </tr>
                </thead>
                <tbody className="divide-y divide-gray-100">
                   {MOCK_STUDENTS_FULL.slice(0, 8).map((s, i) => (
                      <tr key={s.id} className="hover:bg-gray-50 transition-colors">
                         <td className="px-6 py-4 font-mono font-bold text-gray-400">{i+1}</td>
                         <td className="px-6 py-4 font-bold text-gray-800">{s.name} <span className="text-xs text-gray-400 font-normal">({s.dept})</span></td>
                         <td className="px-6 py-4">
                            <div className="flex items-center gap-2">
                              <div className="w-16 bg-gray-100 rounded-full h-2 overflow-hidden">
                                <div className="bg-blue-500 h-full rounded-full" style={{width: `${s.attendRate}%`}}></div>
                              </div>
                              <span className="font-mono text-xs font-bold">{s.attendRate}%</span>
                            </div>
                         </td>
                         <td className="px-6 py-4 font-medium text-gray-600">92ì </td>
                         <td className="px-6 py-4 font-medium text-gray-600">88ì </td>
                         <td className="px-6 py-4"><Badge type={s.score === 'S' ? 'brand' : s.score === 'A' ? 'primary' : 'neutral'}>{s.score} ë“±ê¸‰</Badge></td>
                         <td className="px-6 py-4 text-center">
                            <button className="text-gray-400 hover:text-blue-600 hover:bg-blue-50 p-2 rounded-lg transition-all"><FileText size={18}/></button>
                         </td>
                      </tr>
                   ))}
                </tbody>
             </table>
          </div>
       </Card>
    </div>
  );
}

// --- User Mobile App (Unchanged) ---
function UserMobileApp({ showToast }) {
  const [activeTab, setActiveTab] = useState('home');
  const [isScanning, setIsScanning] = useState(false);
  const [showAppealModal, setShowAppealModal] = useState(false);

  const handleScan = () => {
    setIsScanning(true);
    setTimeout(() => {
      setIsScanning(false);
      showToast("ì¶œì„ ì¸ì¦ ì„±ê³µ! ğŸ”¥", "success");
    }, 2000);
  };

  return (
    <div className="flex justify-center items-center min-h-screen bg-[#E5E5E5] py-8 font-sans selection:bg-blue-500 selection:text-white">
      {/* Mobile Frame - iPhone 15 Style */}
      <div className="bg-[#F2F4F6] w-[400px] h-[860px] rounded-[55px] shadow-2xl border-[12px] border-black relative overflow-hidden flex flex-col ring-8 ring-gray-300/50">
        
        {/* Dynamic Island Area */}
        <div className="absolute top-0 w-full h-14 z-50 flex justify-between items-center px-8 pt-4 text-sm font-bold text-gray-900">
           <span>09:41</span>
           <div className="w-[120px] h-[36px] bg-black rounded-full absolute left-1/2 transform -translate-x-1/2 top-[11px] flex items-center justify-center gap-2">
              <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
              <span className="text-[10px] text-white font-medium">Live Activity</span>
           </div>
           <div className="flex gap-1.5">
              <div className="w-5 h-3 bg-gray-900 rounded-[2px]"></div>
              <div className="w-0.5 h-1.5 bg-gray-900 absolute right-[28px] top-[20px]"></div>
           </div>
        </div>

        {/* Dynamic Content */}
        <div className="flex-1 overflow-y-auto pb-24 pt-16 scrollbar-hide">
          {activeTab === 'home' ? (
             <UserHome handleScan={handleScan} />
          ) : (
             <UserHistory setShowAppealModal={setShowAppealModal} />
          )}
        </div>

        {/* Glass Bottom Navigation */}
        <div className="absolute bottom-6 left-6 right-6 h-[80px] bg-white/90 backdrop-blur-xl rounded-[32px] shadow-2xl shadow-gray-200/50 flex justify-around items-center px-2 z-40 border border-white/50">
           <NavIcon icon={<LayoutDashboard />} label="í™ˆ" active={activeTab === 'home'} onClick={() => setActiveTab('home')} />
           <div className="relative -top-8 group">
             <button 
               onClick={handleScan}
               className="w-16 h-16 bg-gray-900 rounded-[24px] flex items-center justify-center text-white shadow-xl shadow-gray-400/50 hover:scale-110 hover:shadow-2xl transition-all duration-300 active:scale-95 group-hover:bg-[#0046FF]">
               <QrCode size={28} />
             </button>
           </div>
           <NavIcon icon={<FileText />} label="ë‚´ ê¸°ë¡" active={activeTab === 'history'} onClick={() => setActiveTab('history')} />
        </div>

        {/* Scan Overlay */}
        {isScanning && (
          <div className="absolute inset-0 bg-black/90 z-50 flex flex-col items-center justify-center text-white animate-fade-in backdrop-blur-sm">
             <div className="w-72 h-72 border-[3px] border-[#0046FF] rounded-[40px] relative flex items-center justify-center overflow-hidden bg-white/5 shadow-[0_0_50px_rgba(0,70,255,0.3)]">
               <div className="w-full h-1.5 bg-gradient-to-r from-transparent via-[#0046FF] to-transparent absolute top-0 animate-scan-vertical shadow-[0_0_20px_#0046FF]"></div>
               <Camera size={64} className="text-white/20" />
               <div className="absolute bottom-6 text-xs font-mono text-blue-300 bg-blue-900/30 px-3 py-1 rounded-full">DETECTING QR...</div>
             </div>
             <p className="mt-10 font-bold text-lg animate-pulse flex items-center gap-2"><div className="w-2 h-2 bg-blue-500 rounded-full"></div> QR ì½”ë“œë¥¼ ì°¾ëŠ” ì¤‘...</p>
             <button onClick={() => setIsScanning(false)} className="mt-8 px-8 py-3 rounded-full bg-white/10 text-sm font-bold hover:bg-white/20 transition-colors">ì·¨ì†Œ</button>
          </div>
        )}

        {/* Appeal Modal */}
        {showAppealModal && (
           <div className="absolute inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-end animate-fade-in">
              <div className="bg-[#F2F4F6] w-full rounded-t-[40px] p-8 pb-12 animate-slide-up shadow-2xl">
                 <div className="w-12 h-1.5 bg-gray-300 rounded-full mx-auto mb-8"></div>
                 <h3 className="font-bold text-2xl mb-6 text-gray-900">ì†Œëª… ì‹ ì²­ ğŸ“</h3>
                 <div className="space-y-5">
                    <div className="bg-white p-4 rounded-2xl border border-gray-100">
                       <label className="text-xs font-bold text-gray-400 block mb-2 uppercase tracking-wide">Date</label>
                       <div className="font-bold text-gray-800">2026.10.12 (ì§€ê°)</div>
                    </div>
                    <div>
                       <label className="text-xs font-bold text-gray-400 block mb-2 uppercase tracking-wide">Reason</label>
                       <select className="w-full border-none bg-white rounded-2xl p-4 text-sm font-bold text-gray-800 focus:ring-2 focus:ring-blue-500 shadow-sm">
                          <option>ğŸšŒ ëŒ€ì¤‘êµí†µ ì§€ì—°</option>
                          <option>ğŸ¥ ë³‘ì› ì§„ë£Œ</option>
                          <option>ğŸ’ ê²½ì¡°ì‚¬</option>
                          <option>âœï¸ ê¸°íƒ€ (ì§ì ‘ ì…ë ¥)</option>
                       </select>
                    </div>
                    <div>
                       <label className="text-xs font-bold text-gray-400 block mb-2 uppercase tracking-wide">Photo Evidence</label>
                       <div className="border-2 border-dashed border-gray-300 rounded-2xl p-6 text-center text-gray-400 bg-white hover:bg-gray-50 transition-colors cursor-pointer">
                          <Camera className="mx-auto mb-2 text-gray-300" size={32} />
                          <span className="text-xs font-bold">í„°ì¹˜í•˜ì—¬ ì‚¬ì§„ ì—…ë¡œë“œ</span>
                       </div>
                    </div>
                    <Button className="w-full h-14 mt-4 text-lg shadow-lg shadow-blue-200" onClick={() => {showToast("ì‹ ì²­ì´ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤! âœ…"); setShowAppealModal(false);}}>ì œì¶œí•˜ê¸°</Button>
                 </div>
              </div>
           </div>
        )}
      </div>
    </div>
  );
}

function UserHome({ handleScan }) {
  return (
    <div className="px-7 space-y-8">
      <div className="flex justify-between items-center mt-2">
        <div>
          <p className="text-gray-500 font-bold text-sm mb-0.5">Welcome back,</p>
          <h2 className="text-3xl font-black text-gray-900 tracking-tight">Kim Shinhan <span className="text-2xl">ğŸ‘‹</span></h2>
        </div>
        <div className="w-14 h-14 bg-gradient-to-tr from-blue-500 to-purple-500 p-[2px] rounded-full shadow-lg shadow-blue-200">
           <div className="w-full h-full bg-white rounded-full flex items-center justify-center overflow-hidden">
             <span className="font-black text-xl gradient-text">K</span>
           </div>
        </div>
      </div>

      <div className="bg-white p-6 rounded-[32px] shadow-[0_10px_40px_rgba(0,0,0,0.03)] border border-white">
        <div className="flex justify-between items-center mb-6">
           <h3 className="font-bold text-gray-800 text-sm flex items-center gap-2">MY STATUS <div className="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div></h3>
           <span className="text-xs font-bold text-gray-400 bg-gray-50 px-2 py-1 rounded-lg">2026 OCT</span>
        </div>
        <div className="flex justify-between items-start gap-2">
           <StatusItem value="95%" label="Attendance" color="green" icon={<CheckCircle size={16}/>} />
           <div className="w-px h-12 bg-gray-100 self-center"></div>
           <StatusItem value="1ê±´" label="To-Do" color="yellow" icon={<AlertCircle size={16}/>} />
           <div className="w-px h-12 bg-gray-100 self-center"></div>
           <StatusItem value="A" label="Grade" color="blue" icon={<TrendingUp size={16}/>} />
        </div>
      </div>

      <div className="relative group cursor-pointer" onClick={handleScan}>
        <div className="absolute inset-0 bg-gradient-to-r from-blue-600 to-purple-600 rounded-[32px] blur-xl opacity-40 group-hover:opacity-60 transition-opacity duration-500"></div>
        <div className="relative bg-[#0F172A] p-7 rounded-[32px] text-white shadow-2xl overflow-hidden border border-white/10">
          <div className="absolute -right-10 -top-10 w-40 h-40 bg-blue-500 rounded-full blur-3xl opacity-20"></div>
          
          <div className="flex justify-between items-start mb-6 relative z-10">
             <Badge type="neutral" className="bg-white/10 text-white border-0 backdrop-blur-md">TODAY</Badge>
             <div className="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center backdrop-blur-md"><MoreVertical size={16}/></div>
          </div>
          
          <h2 className="text-2xl font-black leading-tight mb-8 relative z-10">2026 ë””ì§€í„¸ ê¸ˆìœµ<br/>ë¦¬í„°ëŸ¬ì‹œ ì‹¬í™” <span className="text-blue-400">3ì°¨ì‹œ</span></h2>
          
          <div className="space-y-3 relative z-10">
             <div className="flex items-center gap-3 text-sm font-medium text-gray-300">
               <div className="p-2 bg-white/5 rounded-xl"><Clock size={16} className="text-blue-400"/></div>
               <span>14:00 ~ 18:00 (4H)</span>
             </div>
             <div className="flex items-center gap-3 text-sm font-medium text-gray-300">
               <div className="p-2 bg-white/5 rounded-xl"><Users size={16} className="text-purple-400"/></div>
               <span>ì‹ í•œì€í–‰ ë³¸ì  20ì¸µ ëŒ€ê°•ë‹¹</span>
             </div>
          </div>

          <div className="absolute bottom-6 right-6 w-12 h-12 bg-white text-blue-600 rounded-full flex items-center justify-center shadow-lg transform group-hover:scale-110 transition-transform">
             <ArrowRight size={20} />
          </div>
        </div>
      </div>

      <div className="bg-white rounded-2xl p-4 flex items-center gap-4 shadow-sm border border-gray-100">
         <div className="bg-red-50 p-2.5 rounded-xl text-red-500">
            <Bell size={18} />
         </div>
         <div className="flex-1">
            <p className="text-sm font-bold text-gray-800">ë‚´ì¼ ì‚¬ì „ ê³¼ì œ ë§ˆê° ğŸš¨</p>
            <p className="text-xs text-gray-400 truncate">ë¦¬ë”ì‹­ ì—­ëŸ‰ ê°•í™” ê³¼ì • - ìê¸°ì†Œê°œì„œ ì œì¶œ</p>
         </div>
         <ChevronRight size={16} className="text-gray-300" />
      </div>
    </div>
  );
}

function UserHistory({ setShowAppealModal }) {
  const history = [
    { date: "10.14", title: "ë””ì§€í„¸ ë¦¬í„°ëŸ¬ì‹œ (3ì°¨)", status: "present", time: "13:55" },
    { date: "10.13", title: "ê¸ˆìœµ ë°ì´í„° ë¶„ì„ (2ì°¨)", status: "present", time: "08:50" },
    { date: "10.12", title: "ë¦¬ë”ì‹­ ì—­ëŸ‰ ê°•í™”", status: "late", time: "09:40" },
    { date: "10.10", title: "ê²½ì˜ ì „ëµ ì›Œí¬ìƒµ", status: "absent", time: "-" },
  ];

  return (
    <div className="px-7 space-y-6">
      <h2 className="font-black text-2xl text-gray-900">History ğŸ—“ï¸</h2>
      <div className="space-y-4">
        {history.map((item, i) => (
          <div key={i} className="bg-white p-5 rounded-[24px] border border-gray-100 shadow-sm flex items-center justify-between group active:scale-95 transition-all hover:shadow-md">
            <div className="flex items-center gap-5">
              <div className="w-14 h-14 bg-gray-50 rounded-2xl flex flex-col items-center justify-center border border-gray-100 group-hover:bg-blue-50 group-hover:border-blue-100 transition-colors">
                <span className="text-[10px] text-gray-400 font-bold uppercase">{item.date.split('.')[0]} OCT</span>
                <span className="font-black text-gray-800 text-xl leading-none">{item.date.split('.')[1]}</span>
              </div>
              <div>
                <h4 className="font-bold text-sm text-gray-800 mb-1">{item.title}</h4>
                <div className="flex items-center gap-1.5 text-xs font-medium text-gray-400">
                   <Clock size={12}/> {item.time === '-' ? 'ê¸°ë¡ ì—†ìŒ' : `${item.time} Checked`}
                </div>
              </div>
            </div>
            <div className="flex flex-col items-end gap-2">
               {item.status === 'present' && <span className="text-green-600 bg-green-50 px-2.5 py-1 rounded-lg text-[10px] font-bold border border-green-100">ATTENDED</span>}
               {item.status === 'late' && <span className="text-yellow-600 bg-yellow-50 px-2.5 py-1 rounded-lg text-[10px] font-bold border border-yellow-100">LATE</span>}
               {item.status === 'absent' && <span className="text-red-600 bg-red-50 px-2.5 py-1 rounded-lg text-[10px] font-bold border border-red-100">ABSENT</span>}
               {item.status !== 'present' && (
                  <button onClick={() => setShowAppealModal(true)} className="text-[10px] font-bold text-blue-500 hover:text-blue-700 bg-blue-50 px-2 py-0.5 rounded-md">ì†Œëª…í•˜ê¸°</button>
               )}
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

// --- Helper Components ---

function NavItem({ icon, label, active, onClick, collapsed }) {
  return (
    <button 
      onClick={onClick}
      className={`w-full flex items-center ${collapsed ? 'justify-center px-0' : 'px-5 gap-3.5'} py-3.5 rounded-2xl transition-all mb-1 ${active ? 'bg-white shadow-lg shadow-gray-100 text-[#0046FF] font-bold' : 'text-gray-500 font-medium hover:bg-white/50 hover:text-gray-800'}`}
      title={label}
    >
      {React.cloneElement(icon, { strokeWidth: active ? 2.5 : 2, size: 20 })}
      {!collapsed && (
        <>
          <span className="text-sm whitespace-nowrap">{label}</span>
          {active && <div className="ml-auto w-2 h-2 rounded-full bg-[#0046FF] shadow-sm"></div>}
        </>
      )}
    </button>
  );
}

function StatCard({ title, value, sub, color, icon, onClick, cursor, trend }) {
  const styles = {
    blue: "text-blue-600 bg-blue-50 border-blue-100",
    red: "text-red-600 bg-red-50 border-red-100",
    purple: "text-purple-600 bg-purple-50 border-purple-100",
    green: "text-green-600 bg-green-50 border-green-100"
  };

  return (
    <div onClick={onClick} className={`glass-card p-6 rounded-2xl flex flex-col justify-between hover:shadow-lg transition-all border border-white/50 ${cursor ? 'cursor-pointer hover:border-purple-200' : ''}`}>
      <div className="flex justify-between items-start mb-4">
        <div className={`p-3 rounded-2xl ${styles[color]}`}>
          {React.cloneElement(icon, { size: 22, strokeWidth: 2.5 })}
        </div>
        <span className={`text-[10px] font-bold px-2 py-1 rounded-full ${trend === 'New' ? 'bg-red-100 text-red-600' : 'bg-gray-100 text-gray-500'}`}>{trend}</span>
      </div>
      <div>
        <p className="text-xs font-bold text-gray-400 uppercase tracking-wide mb-1">{title}</p>
        <h3 className="text-2xl font-black text-gray-800 tracking-tight">{value}</h3>
        <p className="text-xs font-medium text-gray-500 mt-2 flex items-center gap-1">{sub}</p>
      </div>
    </div>
  );
}

function IssueItem({ name, dept, time, issue, type, emoji }) {
   return (
      <div className="flex items-center gap-3 p-3 bg-white rounded-2xl border border-gray-100 hover:shadow-md transition-all cursor-pointer group hover:border-blue-200">
         <div className="text-2xl bg-gray-50 w-10 h-10 flex-shrink-0 flex items-center justify-center rounded-2xl group-hover:scale-110 transition-transform">{emoji}</div>
         <div className="flex-1 min-w-0">
            <div className="flex justify-between items-center mb-1 gap-2">
               <span className="font-bold text-sm text-gray-900 truncate">{name} <span className="text-xs font-medium text-gray-400 ml-1">{dept}</span></span>
               <span className="text-xs font-bold text-gray-300 bg-gray-50 px-2 py-0.5 rounded-md flex-shrink-0">{time}</span>
            </div>
            <p className={`text-xs font-bold truncate ${type === 'danger' ? 'text-red-500' : 'text-yellow-600'}`}>{issue}</p>
         </div>
         <ChevronRight size={16} className="text-gray-300 group-hover:text-blue-500 group-hover:translate-x-1 transition-all flex-shrink-0"/>
      </div>
   )
}

function StatusItem({ value, label, color, icon }) {
  const colors = {
    green: "text-green-500 bg-green-50",
    yellow: "text-yellow-500 bg-yellow-50",
    blue: "text-blue-500 bg-blue-50"
  };

  return (
    <div className="flex flex-col items-center gap-1 flex-1">
      <div className={`w-8 h-8 rounded-full ${colors[color]} flex items-center justify-center mb-1`}>
        {icon}
      </div>
      <span className="font-black text-xl text-gray-800 tracking-tight">{value}</span>
      <span className="text-[10px] font-bold text-gray-400 uppercase tracking-wide">{label}</span>
    </div>
  );
}
